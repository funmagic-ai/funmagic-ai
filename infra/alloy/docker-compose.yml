services:
  alloy:
    image: grafana/alloy:latest
    container_name: funmagic-alloy
    restart: unless-stopped
    command:
      - run
      - /etc/alloy/config.alloy
    volumes:
      - ./config.alloy:/etc/alloy/config.alloy:ro
      # Production only: mount PM2 log directory for Loki log collection
      # Uncomment on the production server where PM2 runs:
      # - /root/.pm2/logs:/root/.pm2/logs:ro
    network_mode: host # Access localhost metrics endpoints
    env_file:
      - ../../.env
